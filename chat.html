<html>

<head>
    <link rel="stylesheet" href="style.css">
    <li class="list-item"><a href="file.html"></a></li>
</head>

<div id="out">
</div>

<div>
    <form action="tea.php" method="POST">
        <input type="text" id="message" name="message">
    </form>
    <input type="submit" value="Send">

    <div class="emoji-list">

      <div class="emoji-row">
        <p id="em">&#128540</p>
        <p id="em">&#128512</p>
        <p id="em">&#128513</p>
        <p id="em">&#128514</p>

    </div>

    <div class="emoji-row">
        <p id="em">&#128515</p>
        <p id="em">&#128516</p>
        <p id="em">&#128517</p>
        <p id="em">&#128518</p>
    </div>

    <div class="emoji-row">

        <p id="em">&#128519</p>
        <p id="em">&#128520</p>
        <p id="em">&#128521</p>
        <p id="em">&#128522</p>

    </div>
</div>
</div>
<script>
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open('GET', 'http://localhost/tea.php', true);
    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4) {
            if (xmlhttp.status == 200) {
                var messages = JSON.parse(xmlhttp.responseText);
                console.log(messages);
                var cnt = 0;
                for (const msg of messages) {

                    var div = document.createElement("div");
                    div.className = cnt++ % 2 == 0 ? "container" : "container darker";
                    var para = document.createElement("p");
                    var node = document.createTextNode(msg["text"]);
                    para.appendChild(node);
                    div.appendChild(para);

                    var span = document.createElement("span");
                    span.className = "time-left";
                    var time = document.createTextNode(msg["date"]);
                    span.appendChild(time);

                    div.appendChild(span);
                    var element = document.getElementById("out");
                    element.appendChild(div);
                }
            }
        }
    };
    xmlhttp.send();
</script>

</html>